# Happy Work软件使用帮助

```
本文件为Happy Work的官方（其实就是我自己写的帮助文档）使用教程，其目的为解释Happy Work的功能，同时介绍如何结合自己负责的项目实际情况进行操作
```

[TOC]

-------------------------

## 软件介绍

###开发历史介绍

Happy Work是一个自动制作合同及补充协议的软件。由我在八月份的一个晚上边吃饭边看电影开发出来的，最初软件是由Python写成，代码量仅为400行，主要功能是对合同中`{变量名称}`进行替换，同时加入了日期的简单处理和金额的简单纠错行为。

后来打算将其做成一个拓展为`exe`的文件，方便在其他电脑上进行操作，便用C++进行重写，然而在进行Word文档交互的过程中，遇到了一些麻烦。于是在2017年九月初，利用了三个晚上学习了一下C#，并用一周时间将Happy Work的正式版本开发出来，经过多次更新和纠错，最终成为现在这个样子。

目前Happy Work仍处于测试阶段，但是已经可以进行使用，请大家在遇到问题的时候告诉我，以便我进行修改和维护。

### 软件功能简介

Happy Work其实是一个简单的文本替换工具，只是在一定程度上提供了记忆功能，方便将一些可以复用的信息进行记录，以便下一次进行使用。同时增加了时间的自动处理和金额自动转换功能，方便使用。软件原理十分简单，毕竟城市公司发来的文件样式不一样，导致统一分析十分困难，因此依然依赖于人工把数据输入进去。

-------------

## 系统及配置要求

###硬件配置

软件对电脑配置要求极低。

### 系统配置

最低系统要求：`Windows XP`

依赖要求：`.net framework 4.6.1或以上`以及`Docx`，均在安装包中包含。

------------------------

## 软件功能介绍

软件功能分为三部分：

- 替换
- 自动填充
- 记忆

### 替换

​	替换功能实际上就是简单的文本替换，软件会读取模板文件，将其中用大括号`{}`括起来的部分进行分析，我把大括号中包含的部分称为`变量`，软件会自动读取一遍模板文件，将需要提供具体内容的变量展示在软件中，供用户输入，当输入所有变量所对应的值时，点击替换按钮可以进行替换，软件会把每个变量替换为对应的内容，字体以及格式不发生改变。

### 自动填充

​	自动填充功能是针对部分特殊的`变量`设计的，比如当输入资金的小写金额时，会自动填充大写金额，当软件打开时，会自动将年月日等信息填充进去。

### 记忆

​	软件设计了记忆功能，可以将供应商信息、工程信息进行记忆保存，软件没有提供任何网络操作，因此信息仅保存在本地，若想要共享，可将相关信息复制到相关路径，详细见下文。当重复使用一家供应商时，保存重复的信息将会便于我们完成一份合同，当生成对应某一份合同的补充协议时，保存合同信息也有利于我们制作补充协议。

----------

## 变量介绍

```
官方提供的模板文件中（其实就是我！！！辛辛苦苦起早贪黑的O(∩_∩)O~~），包含了一部分变量，下文将会具体解释这些变量的意思和用法。同时软件对于一些特殊名字的变量会有特殊处理，下文也会指出。
```

### 特殊变量

特殊变量预定义在软件中，由软件进行特殊处理。（特殊变量暂时不能自定义，是的，就是因为我懒得设计这个功能）。下文将会对特殊变量进行详细介绍，当自己制作模板文件的时候，可以使用这些预设好的特殊变量，从而带来方便。

1. `年` 、`月` 、`日` 、`补年` 、`补月` 、 `补日`，这几个变量代表了采购合同或采购补充协议上要书写的日期，格式分别为####、##、##。例如2017年1月3日，其中“年”为2017，“月”为01，“日”为03。同时在导入合同模板后，这三个变量会默认为今天，可以根据需要进行更改。
2. `销售年`、`销售月` 、`销售日` 、`补销售年` 、`补销售月` 、 `补销售日`，这几个变量代表了销售合同或销售补充协议上要书写的日期，格式分别为####、##、##。例如2017年1月3日，其中“年”为2017，“月”为01，“日”为03。日期如果填写不规范，会报错。该日期是在采购合同或采购补充协议书写日期的基础上加了三天，可以自定义增加的天数，增加的日期为工作日，因此会自动跳过周末。*（会在后续版本中对工作日进行识别，可以跳过法定假期等非工作日）*
3. `供方名称`，此变量可以在***添加——管理供应商***窗口中进行更改。供方名称代表了供方的公司名称，其会自动记录并保存到软件目录下，在***.\Resources\xml\information***目录中，以***xml***文件的形式进行保存。当想手动添加供方信息的时候，可以将其他人写好的供方信息文件粘贴到此文件中，软件会自动识别。此变量会以下拉菜单的方式展示出来，必须先保存供应商信息，再进行操作。
4. `销售人`、`销售电话`、`品牌名称`、`账户名称`、`开户银行`、`账号`、`交货时间`。这几个特殊变量均会在改变供方名称的时候自动填充上去，其相关信息均可以通过合同要素表或者其他途径获得，"交货时间"需要根据不同项目的习惯书写。
5. `采购小写金额`、`采购大写金额`、`销售小写金额`、`销售大写金额`、`补采购小写金额`、`补采购大写金额`、`补销售小写金额`、`补销售大写金额`，均会在书写小写金额的时候自动匹配生成大写金额，同时小写金额会自动添加上千分位符号，如果手动填写小写金额包含千分位符号，也不会影响金额转大写功能。
6. `采购增补小写金额`、`销售增补小写金额`、`采购增补大写金额`、`销售增补大写金额`，这四个变量会根据补充协议中已经输入的关于金额的特殊变量自动计算得出。比如当输入了“采购小写金额”和“补采购小写金额”时，“采购增补小写金额”和“采购增补大写金额”会自动计算得出。
7. `违约金`，违约金会根据预定好的规则进行自动替换。即小于等于一百万，违约金为2000，大于一百万小于等于五百万，违约金为5000，大于五百万违约金为20000。

**PS：名称中第一个字为“补”的变量仅在制作补充协议的时候具有特殊功能**



###其他预定义变量

```
除了上文中说明的一些特殊变量之外，模板文件中还包含了一些其他变量，这些变量不具有特殊功能，但是会说明一下每个变量的意思和应该书写的格式。
```

|   变量名称   |               举例               |                备注                |
| :------: | :----------------------------: | :------------------------------: |
|   项目名称   | 华发·九龙湾（住宅）一期1.2期（四标段）配电箱（公共区域） |             按照合同要素表写             |
|   项目类型   |              配电箱               |           用来替换战略协议中的内容           |
|   是否续签   |         checked or not         |      主要用来确定是否在战略协议编号中显示“续”       |
|   协议编号   |            17003-3             |                                  |
|   合同编号   |               6                |             这一份合同的编号             |
|  战略协议年度  |           2017-2018            |                                  |
|   项目地点   |              威海市               |         写项目所在的城市，注意带上“市”         |
|   交货地点   |                                | 合同要素表上的写法，注意“ 甲方/实际接收方指定地点“不需要书写 |
|    品牌    |               天泓               |                                  |
| 补充协议调价原因 |     增加产品型号规格、数量，现就合同价款等事宜      |         根据实际情况写，如果没有就不用写         |
| 是否添加调价原因 |         checked or not         |        如果有调价原因，就勾上，否则别勾上。        |

### 特殊变量语法

```
软件提供了一种特殊的变量用法，必须以b开头，同时带有冒号，具体以下文中模板形式为准，可以将其变成checkbox形式。其有两个后选值，如果打钩则选择第一个，如果没有打钩则选择第二个。用法如下：
```

语法的形式为：**{b:变量名称:第一候选值:第二候选值}**

解释：`b`代表这是个特殊变量，要以`CheckBox`的形式展示出来。

​	   `变量名称`代表这个变量的名字，会在软件中显示出来。

​	   `第一候选值`代表当打钩的时候所对应的值

​	   `第二候选值`代表了不打钩的时候所对应的值

备注：

​	候选值为空的时候，将其空出来即可。当第二个候选值为空的时候，可以写成如下形式：

​	**{b:变量名称:第一候选值:}**或者**{b:变量名称:第一候选值}**